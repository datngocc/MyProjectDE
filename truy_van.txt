1.Tổng số lượt thuê xe theo mùa, theo năm

SELECT 
    d.YEAR,
    s.SEASON_NAME,
    SUM(f.TOTAL_COUNT) AS TOTAL_RENTALS
FROM FACT_BIKE_RENTALS_DAY f
JOIN DIM_DATE d ON f.DATE_KEY = d.DATE_KEY
JOIN DIM_SEASON s ON f.SEASON_KEY = s.SEASON_KEY
GROUP BY d.YEAR, s.SEASON_NAME
ORDER BY d.YEAR, s.SEASON_NAME;

2. Thống kê theo giờ trong ngày (giờ cao điểm và không)

SELECT 
    h.PERIOD_OF_DAY,
    h.IS_PEAK_HOUR,
    AVG(f.TOTAL_COUNT) AS AVG_RENTALS
FROM FACT_BIKE_RENTALS_HOUR f
JOIN DIM_HOUR h ON f.HOUR_KEY = h.HOUR_KEY
GROUP BY h.PERIOD_OF_DAY, h.IS_PEAK_HOUR;

3. Ảnh hưởng của thời tiết đến số lượt thuê xe

SELECT 
    w.DESCRIPTION AS WEATHER_TYPE,
    ROUND(AVG(f.TOTAL_COUNT), 2) AS AVG_RENTALS
FROM FACT_BIKE_RENTALS_DAY f
JOIN DIM_WEATHER w ON f.WEATHER_KEY = w.WEATHER_KEY
GROUP BY w.DESCRIPTION
ORDER BY AVG_RENTALS DESC;

4. Lượt thuê theo ngày trong tuần

SELECT 
    WEEKDAY,
    CASE WHEN IS_WEEKEND THEN 'Weekend' ELSE 'Weekday' END AS DAY_TYPE,
    AVG(TOTAL_COUNT) AS AVG_RENTALS
FROM FACT_BIKE_RENTALS_DAY f
JOIN DIM_DATE d ON f.DATE_KEY = d.DATE_KEY
GROUP BY WEEKDAY, IS_WEEKEND
ORDER BY WEEKDAY;

5. Thống kê giờ cao điểm theo ngày trong tuần

SELECT 
    d.WEEKDAY,
    h.HOUR,
    AVG(f.TOTAL_COUNT) AS AVG_RENTALS
FROM FACT_BIKE_RENTALS_HOUR f
JOIN DIM_DATE d ON f.DATE_KEY = d.DATE_KEY
JOIN DIM_HOUR h ON f.HOUR_KEY = h.HOUR_KEY
GROUP BY d.WEEKDAY, h.HOUR
ORDER BY d.WEEKDAY, h.HOUR;

6. Thống kê số lượt thuê theo điều kiện thời tiết

SELECT 
    w.DESCRIPTION AS WEATHER_DESC,
    ROUND(AVG(f.TOTAL_COUNT), 2) AS AVG_RENTALS,
    ROUND(AVG(f.TEMPERATURE), 2) AS AVG_TEMP
FROM FACT_BIKE_RENTALS_DAY f
JOIN DIM_WEATHER w ON f.WEATHER_KEY = w.WEATHER_KEY
GROUP BY w.DESCRIPTION
ORDER BY AVG_RENTALS DESC;

7. So sánh thuê xe vào ngày lễ vs ngày thường

SELECT 
    d.IS_WEEKEND,
    f.HOLIDAY_FLAG,
    ROUND(AVG(f.TOTAL_COUNT), 2) AS AVG_RENTALS
FROM FACT_BIKE_RENTALS_DAY f
JOIN DIM_DATE d ON f.DATE_KEY = d.DATE_KEY
GROUP BY d.IS_WEEKEND, f.HOLIDAY_FLAG
ORDER BY f.HOLIDAY_FLAG DESC, d.IS_WEEKEND;

8. Tăng trưởng số lượt thuê theo tháng

SELECT 
    d.YEAR,
    d.MONTH,
    SUM(f.TOTAL_COUNT) AS TOTAL_RENTALS
FROM FACT_BIKE_RENTALS_DAY f
JOIN DIM_DATE d ON f.DATE_KEY = d.DATE_KEY
GROUP BY d.YEAR, d.MONTH
ORDER BY d.YEAR, d.MONTH;

9. Tỉ lệ người thuê: casual vs registered

SELECT 
    ROUND(SUM(CASUAL_COUNT) / SUM(TOTAL_COUNT) * 100, 2) AS PERCENT_CASUAL,
    ROUND(SUM(REGISTERED_COUNT) / SUM(TOTAL_COUNT) * 100, 2) AS PERCENT_REGISTERED
FROM FACT_BIKE_RENTALS_DAY;

10. Ảnh hưởng của nhiệt độ đến lượt thuê

SELECT 
    ROUND(TEMPERATURE, 1) AS TEMP_BUCKET,
    ROUND(AVG(TOTAL_COUNT), 2) AS AVG_RENTALS
FROM FACT_BIKE_RENTALS_DAY
GROUP BY ROUND(TEMPERATURE, 1)
ORDER BY TEMP_BUCKET;
